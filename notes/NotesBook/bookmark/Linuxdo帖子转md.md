javascript:(function()%7Bjavascript%3A%20(function%20()%20%7B%0A%20%20const%20HtmlToMarkdown%20%3D%20%7B%0A%20%20%20%20init()%20%7B%0A%20%20%20%20%20%20this.codeBlocks%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20this.footnotes%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20this.metadata%20%3D%20%7B%7D%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20rules%3A%20%5B%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cbr%5Cs*%5C%2F%3F%3E%2Fgi%2C%20replacement%3A%20'%5Cn'%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pattern%3A%20%2F%3C(strong%7Cb%7Cem%7Ci%7Cdel%7Cs)%3E(.*%3F)%3C%5C%2F%5C1%3E%2Fgi%2C%0A%20%20%20%20%20%20%20%20replacement%3A%20(_%2C%20tag%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20markers%20%3D%20%7B%20strong%3A%20'**'%2C%20b%3A%20'**'%2C%20em%3A%20'*'%2C%20i%3A%20'*'%2C%20del%3A%20'~~'%2C%20s%3A%20'~~'%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20return%20%60%24%7Bmarkers%5Btag.toLowerCase()%5D%7D%24%7Bcontent%7D%24%7Bmarkers%5Btag.toLowerCase()%5D%7D%60%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Chr%5Cs*%5C%2F%3F%3E%2Fgi%2C%20replacement%3A%20'%5Cn---%5Cn'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Ca%5B%5E%3E%5D*href%3D%22(%5B%5E%22%5D*)%22.*%3F%3E(.*%3F)%3C%5C%2Fa%3E%2Fgi%2C%20replacement%3A%20'%5B%242%5D(%241)'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Ccode%5B%5E%3E%5D*%3E(.*%3F)%3C%5C%2Fcode%3E%2Fgi%2C%20replacement%3A%20'%60%241%60'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cp%5B%5E%3E%5D*%3E(.*%3F)%3C%5C%2Fp%3E%2Fgi%2C%20replacement%3A%20'%241%5Cn%5Cn'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cspan%5B%5E%3E%5D*emoji%5B%5E%3E%5D*%3E(%5B%5E%3C%5D*)%3C%5C%2Fspan%3E%2Fgi%2C%20replacement%3A%20'%241'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3A(%5Ba-z_%2B-%5D%2B)%3A%2Fgi%2C%20replacement%3A%20'%3A%241%3A'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cspan%20class%3D%22hashtag%22%3E%23(%5B%5E%3C%5D%2B)%3C%5C%2Fspan%3E%2Fgi%2C%20replacement%3A%20'%23%241'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cspan%20class%3D%22mention%22%3E%40(%5B%5E%3C%5D%2B)%3C%5C%2Fspan%3E%2Fgi%2C%20replacement%3A%20'%40%241'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cmark%3E(.*%3F)%3C%5C%2Fmark%3E%2Fgi%2C%20replacement%3A%20'%3D%3D%3D%241%3D%3D%3D'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Csup%20class%3D%22footnote%22.*%3F%3E(.*%3F)%3C%5C%2Fsup%3E%2Fgi%2C%20replacement%3A%20'%5B%5E%241%5D'%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pattern%3A%20%2F%3Cli%20class%3D%22task-list-item.*%3F%3E%3Cinput.*%3Fchecked%3D%22(.*%3F)%22.*%3F%3E(.*%3F)%3C%5C%2Fli%3E%2Fgi%2C%0A%20%20%20%20%20%20%20%20replacement%3A%20(_%2C%20checked%2C%20content)%20%3D%3E%20%60-%20%5B%24%7Bchecked%20%3F%20'x'%20%3A%20'%20'%7D%5D%20%24%7Bcontent.trim()%7D%5Cn%60%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cspan%20class%3D%22math%22%3E%5C%5C%5C((.*%3F)%5C%5C%5C)%3C%5C%2Fspan%3E%2Fgi%2C%20replacement%3A%20'%24%24%241%24%24'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cdiv%20class%3D%22math%22%3E%5C%5C%5C%5B(.*%3F)%5C%5C%5C%5D%3C%5C%2Fdiv%3E%2Fgi%2C%20replacement%3A%20'%5Cn%24%24%5Cn%241%5Cn%24%24%5Cn'%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pattern%3A%0A%20%20%20%20%20%20%20%20%20%20%2F%3Caside%20class%3D%22quote%5B%5E%3E%5D*%3E%5B%5E%3E%5D*%3Cdiv%20class%3D%22title%22%3E(%5B%5E%3C%5D*)%3C%5C%2Fdiv%3E.*%3F%3Cblockquote%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fblockquote%3E%3C%5C%2Faside%3E%2Fgi%2C%0A%20%20%20%20%20%20%20%20replacement%3A%20(_%2C%20author%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20cleanAuthor%20%3D%20author.replace(%2F%40(%5B%5E%5Cs%5D%2B)%2F%2C%20'%40%241').trim()%3B%0A%20%20%20%20%20%20%20%20%20%20return%20%60%5Cn%3E%20**%24%7BcleanAuthor%7D%3A**%5Cn%24%7Bcontent%0A%20%20%20%20%20%20%20%20%20%20%20%20.split('%5Cn')%0A%20%20%20%20%20%20%20%20%20%20%20%20.map(line%20%3D%3E%20%60%3E%20%24%7Bline.trim()%7D%60)%0A%20%20%20%20%20%20%20%20%20%20%20%20.join('%5Cn')%7D%5Cn%60%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pattern%3A%20%2F%3Cdiv%20class%3D%22onebox%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fdiv%3E%2Fgi%2C%0A%20%20%20%20%20%20%20%20replacement%3A%20(_%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20title%20%3D%20content.match(%2F%3Ch3%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fh3%3E%2Fi)%3B%0A%20%20%20%20%20%20%20%20%20%20const%20link%20%3D%20content.match(%2Fhref%3D%22(%5B%5E%22%5D*)%22%2Fi)%3B%0A%20%20%20%20%20%20%20%20%20%20const%20description%20%3D%20content.match(%2F%3Cp%20class%3D%22description%22%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fp%3E%2Fi)%3B%0A%20%20%20%20%20%20%20%20%20%20let%20markdown%20%3D%20'%5Cn'%3B%0A%20%20%20%20%20%20%20%20%20%20if%20(title%20%26%26%20link)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20markdown%20%2B%3D%20%60%5B%24%7Btitle%5B1%5D.trim()%7D%5D(%24%7Blink%5B1%5D%7D)%5Cn%60%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20(description)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20markdown%20%2B%3D%20%60%3E%20%24%7Bdescription%5B1%5D.trim()%7D%5Cn%60%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20markdown%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pattern%3A%20%2F%3Cdiv%20class%3D%22poll%22%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fdiv%3E%2Fgi%2C%0A%20%20%20%20%20%20%20%20replacement%3A%20(_%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20title%20%3D%20content.match(%2F%3Cdiv%20class%3D%22poll-title%22%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fdiv%3E%2Fi)%3B%0A%20%20%20%20%20%20%20%20%20%20const%20options%20%3D%20content.match(%2F%3Cli%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fli%3E%2Fgi)%3B%0A%20%20%20%20%20%20%20%20%20%20const%20results%20%3D%20content.match(%2F%3Cspan%20class%3D%22percentage%22%3E(%5Cd%2B)%25%3C%5C%2Fspan%3E%2Fgi)%3B%0A%20%20%20%20%20%20%20%20%20%20let%20markdown%20%3D%20'%5Cn**%E6%8A%95%E7%A5%A8%EF%BC%9A'%3B%0A%20%20%20%20%20%20%20%20%20%20markdown%20%2B%3D%20title%20%3F%20title%5B1%5D%20%2B%20'**%5Cn'%20%3A%20'**%5Cn'%3B%0A%20%20%20%20%20%20%20%20%20%20if%20(options)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20options.forEach((option%2C%20index)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20text%20%3D%20option.replace(%2F%3C%5B%5E%3E%5D%2B%3E%2Fg%2C%20'').trim()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20percentage%20%3D%20results%20%3F%20results%5Bindex%5D%3F.match(%2F(%5Cd%2B)%25%2F)%3F.%5B1%5D%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20markdown%20%2B%3D%20%60-%20%5B%20%5D%20%24%7Btext%7D%24%7Bpercentage%20%3F%20%60%20(%24%7Bpercentage%7D%25)%60%20%3A%20''%7D%5Cn%60%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20markdown%20%2B%20'%5Cn'%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Csvg%5B%5E%3E%5D*%3E%5B%5E%3C%5D*%3Cuse%5B%5E%3E%5D*%3E%5B%5E%3C%5D*%3C%5C%2Fuse%3E%3C%5C%2Fsvg%3E%2Fgi%2C%20replacement%3A%20''%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pattern%3A%20%2F%3Cdiv%20class%3D%22uploaded-file%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fdiv%3E%2Fgi%2C%0A%20%20%20%20%20%20%20%20replacement%3A%20(_%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20link%20%3D%20content.match(%2Fhref%3D%22(%5B%5E%22%5D*)%22%2Fi)%3B%0A%20%20%20%20%20%20%20%20%20%20const%20name%20%3D%20content.match(%2Ftitle%3D%22(%5B%5E%22%5D*)%22%2Fi)%3B%0A%20%20%20%20%20%20%20%20%20%20const%20size%20%3D%20content.match(%2Fdata-size%3D%22(%5B%5E%22%5D*)%22%2Fi)%3B%0A%20%20%20%20%20%20%20%20%20%20return%20link%20%3F%20%60%5B%24%7Bname%20%3F%20name%5B1%5D%20%3A%20'%E6%96%87%E4%BB%B6'%7D%5D(%24%7Blink%5B1%5D%7D)%24%7Bsize%20%3F%20%60%20(%24%7Bsize%5B1%5D%7D)%60%20%3A%20''%7D%60%20%3A%20''%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cimg%5B%5E%3E%5D*emoji%5B%5E%3E%5D*alt%3D%22(%5B%5E%22%5D*)%22%5B%5E%3E%5D*%3E%2Fgi%2C%20replacement%3A%20'%3A%241%3A'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cspan%5B%5E%3E%5D*emoji%5B%5E%3E%5D*%3E(%5B%5E%3C%5D*)%3C%5C%2Fspan%3E%2Fgi%2C%20replacement%3A%20'%3A%241%3A'%20%7D%2C%0A%20%20%20%20%20%20%7B%20pattern%3A%20%2F%3Cspan%5B%5E%3E%5D*mention%5B%5E%3E%5D*%3E(%40%5B%5E%3C%5D%2B)%3C%5C%2Fspan%3E%2Fgi%2C%20replacement%3A%20'%241'%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pattern%3A%20%2F%3C(span%7Cimg)%5B%5E%3E%5D*(emoji%7Cmention)%5B%5E%3E%5D*(%3F%3Aalt%3D%22(%5B%5E%22%5D*)%22%5B%5E%3E%5D*%3E%7C%3E(%5B%5E%3C%5D*))%2Fgi%2C%0A%20%20%20%20%20%20%20%20replacement%3A%20(_%2C%20tag%2C%20type%2C%20alt%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20type%20%3D%3D%3D%20'emoji'%20%3F%20%60%3A%24%7Balt%20%7C%7C%20content%7D%3A%60%20%3A%20%60%40%24%7Bcontent%3F.trim()%20%7C%7C%20alt%7D%60%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%5D%2C%0A%20%20%20%20convert(html)%20%7B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20this.init()%3B%0A%20%20%20%20%20%20%20%20if%20(html.length%20%3E%201000000)%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn('%E5%86%85%E5%AE%B9%E8%BF%87%E5%A4%A7%2C%E5%8F%AF%E8%83%BD%E5%BD%B1%E5%93%8D%E6%80%A7%E8%83%BD')%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20chunkSize%20%3D%20100000%3B%0A%20%20%20%20%20%20%20%20if%20(html.length%20%3E%20chunkSize)%20%7B%0A%20%20%20%20%20%20%20%20%20%20let%20result%20%3D%20''%3B%0A%20%20%20%20%20%20%20%20%20%20for%20(let%20i%20%3D%200%3B%20i%20%3C%20html.length%3B%20i%20%2B%3D%20chunkSize)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20chunk%20%3D%20html.slice(i%2C%20i%20%2B%20chunkSize)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20result%20%2B%3D%20this.processContent(chunk)%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20this.cleanup(result)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20html%20%3D%20this.extractMetadata(html)%3B%0A%20%20%20%20%20%20%20%20html%20%3D%20this.preprocessHtml(html)%3B%0A%20%20%20%20%20%20%20%20let%20text%20%3D%20this.processContent(html)%3B%0A%20%20%20%20%20%20%20%20if%20(this.footnotes.length%20%3E%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20text%20%2B%3D%20'%5Cn%5Cn---%5Cn'%3B%0A%20%20%20%20%20%20%20%20%20%20this.footnotes.forEach((note%2C%20index)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20text%20%2B%3D%20%60%5B%5E%24%7Bindex%20%2B%201%7D%5D%3A%20%24%7Bnote%7D%5Cn%60%3B%0A%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20(Object.keys(this.metadata).length%20%3E%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20frontMatter%20%3D%20%5B'---'%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20coreMetadata%20%3D%20%5B'author'%2C%20'date'%2C%20'source_url'%5D%3B%0A%20%20%20%20%20%20%20%20%20%20for%20(const%20key%20of%20coreMetadata)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.metadata%5Bkey%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20frontMatter.push(%60%24%7Bkey%7D%3A%20%24%7Bthis.metadata%5Bkey%5D%7D%60)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20frontMatter.push('---%5Cn')%3B%0A%20%20%20%20%20%20%20%20%20%20text%20%3D%20frontMatter.join('%5Cn')%20%2B%20text%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20this.cleanup(text)%3B%0A%20%20%20%20%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20%20%20%20%20console.error('%E8%BD%AC%E6%8D%A2%E5%A4%B1%E8%B4%A5%2C%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80%E6%A8%A1%E5%BC%8F%3A'%2C%20error)%3B%0A%20%20%20%20%20%20%20%20return%20this.fallbackConvert(html)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20extractMetadata(html)%20%7B%0A%20%20%20%20%20%20const%20authorMatch%20%3D%20html.match(%2F%3Cdiv%5B%5E%3E%5D*class%3D%22%5B%5E%22%5D*author%5B%5E%22%5D*%22%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fdiv%3E%2Fi)%3B%0A%20%20%20%20%20%20if%20(authorMatch)%20%7B%0A%20%20%20%20%20%20%20%20this.metadata.author%20%3D%20authorMatch%5B1%5D.replace(%2F%3C%5B%5E%3E%5D%2B%3E%2Fg%2C%20'').trim()%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20dateMatch%20%3D%20html.match(%2F%3Ctime%5B%5E%3E%5D*datetime%3D%22(%5B%5E%22%5D*)%22%5B%5E%3E%5D*%3E%2Fi)%3B%0A%20%20%20%20%20%20if%20(dateMatch)%20%7B%0A%20%20%20%20%20%20%20%20this.metadata.date%20%3D%20dateMatch%5B1%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.metadata.source_url%20%3D%20window.location.href%3B%0A%20%20%20%20%20%20return%20html%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20preprocessHtml(html)%20%7B%0A%20%20%20%20%20%20return%20html%0A%20%20%20%20%20%20%20%20.replace(%2F%26nbsp%3B%2Fg%2C%20'%20')%0A%20%20%20%20%20%20%20%20.replace(%2F%26lt%3B%2Fg%2C%20'%3C')%0A%20%20%20%20%20%20%20%20.replace(%2F%26gt%3B%2Fg%2C%20'%3E')%0A%20%20%20%20%20%20%20%20.replace(%2F%26amp%3B%2Fg%2C%20'%26')%0A%20%20%20%20%20%20%20%20.replace(%2F%26quot%3B%2Fg%2C%20'%22')%0A%20%20%20%20%20%20%20%20.replace(%2F%26%2339%3B%2Fg%2C%20%22'%22)%0A%20%20%20%20%20%20%20%20.replace(%2F%3C!--%5B%5Cs%5CS%5D*%3F--%3E%2Fg%2C%20'')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Cscript%5B%5Cs%5CS%5D*%3F%3C%5C%2Fscript%3E%2Fgi%2C%20'')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Cstyle%5B%5Cs%5CS%5D*%3F%3C%5C%2Fstyle%3E%2Fgi%2C%20'')%0A%20%20%20%20%20%20%20%20.replace(%2F%5Cr%5Cn%3F%2Fg%2C%20'%5Cn')%0A%20%20%20%20%20%20%20%20.replace(%2F%5Cs%2B%2Fg%2C%20'%20')%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleError(error%2C%20context)%20%7B%0A%20%20%20%20%20%20console.error(%60%E5%9C%A8%24%7Bcontext%7D%E8%BF%87%E7%A8%8B%E4%B8%AD%E5%8F%91%E7%94%9F%E9%94%99%E8%AF%AF%3A%60%2C%20error)%3B%0A%20%20%20%20%20%20throw%20new%20Error(%60%24%7Bcontext%7D%E5%A4%B1%E8%B4%A5%3A%20%24%7Berror.message%7D%60)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleLocalDates(text)%20%7B%0A%20%20%20%20%20%20return%20text.replace(%2F%3Cspan%5B%5E%3E%5D*discourse-local-date%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fspan%3E%2Fgi%2C%20match%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20dateMatch%20%3D%20match.match(%2Fdata-date%3D%22(%5B%5E%22%5D*)%22%2F)%3B%0A%20%20%20%20%20%20%20%20const%20timeMatch%20%3D%20match.match(%2Fdata-time%3D%22(%5B%5E%22%5D*)%22%2F)%3B%0A%20%20%20%20%20%20%20%20const%20timezoneMatch%20%3D%20match.match(%2Fdata-timezone%3D%22(%5B%5E%22%5D*)%22%2F)%3B%0A%20%20%20%20%20%20%20%20const%20emailPreviewMatch%20%3D%20match.match(%2Fdata-email-preview%3D%22(%5B%5E%22%5D*)%22%2F)%3B%0A%20%20%20%20%20%20%20%20const%20ariaLabelMatch%20%3D%20match.match(%2Faria-label%3D%22(%5B%5E%22%5D*)%22%2F)%3B%0A%20%20%20%20%20%20%20%20if%20(!dateMatch)%20return%20''%3B%0A%20%20%20%20%20%20%20%20if%20(ariaLabelMatch)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20ariaLabelMatch%5B1%5D.replace(%2F%3Cbr%5Cs*%5C%2F%3F%3E%2Fg%2C%20'%2C%20')%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20(emailPreviewMatch)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20emailPreviewMatch%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20textMatch%20%3D%20match.match(%2Frelative-time%22%3E(%5B%5E%3C%5D*)%3C%5C%2Fspan%3E%2F)%3B%0A%20%20%20%20%20%20%20%20if%20(textMatch)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20textMatch%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20date%20%3D%20dateMatch%5B1%5D%3B%0A%20%20%20%20%20%20%20%20const%20time%20%3D%20timeMatch%20%3F%20timeMatch%5B1%5D%20%3A%20''%3B%0A%20%20%20%20%20%20%20%20const%20timezone%20%3D%20timezoneMatch%20%3F%20timezoneMatch%5B1%5D%20%3A%20''%3B%0A%20%20%20%20%20%20%20%20let%20result%20%3D%20date%3B%0A%20%20%20%20%20%20%20%20if%20(time)%20result%20%2B%3D%20%60%20%24%7Btime%7D%60%3B%0A%20%20%20%20%20%20%20%20if%20(timezone)%20result%20%2B%3D%20%60%20%24%7Btimezone%7D%60%3B%0A%20%20%20%20%20%20%20%20return%20result%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleDiscourseDetails(text)%20%7B%0A%20%20%20%20%20%20return%20text.replace(%2F%3Cdetails%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fdetails%3E%2Fgi%2C%20(_%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20summary%20%3D%20content.match(%2F%3Csummary%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fsummary%3E%2Fi)%3B%0A%20%20%20%20%20%20%20%20const%20details%20%3D%20content.replace(%2F%3Csummary%5B%5E%3E%5D*%3E%5B%5Cs%5CS%5D*%3F%3C%5C%2Fsummary%3E%2Fi%2C%20'').trim()%3B%0A%20%20%20%20%20%20%20%20return%20%60%5Cn%3Cdetails%3E%24%7Bsummary%20%3F%20%60%5Cn%3Csummary%3E%24%7Bsummary%5B1%5D%7D%3C%2Fsummary%3E%60%20%3A%20''%7D%5Cn%24%7Bdetails%7D%5Cn%3C%2Fdetails%3E%5Cn%60%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleDiscourseCategories(text)%20%7B%0A%20%20%20%20%20%20return%20text%0A%20%20%20%20%20%20%20%20.replace(%2F%3Cspan%20class%3D%22category-name%22%5B%5E%3E%5D*%3E(%5B%5E%3C%5D%2B)%3C%5C%2Fspan%3E%2Fgi%2C%20'%23%241')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Ca%5B%5E%3E%5D*category%5B%5E%3E%5D*%3E(%5B%5E%3C%5D%2B)%3C%5C%2Fa%3E%2Fgi%2C%20'%23%241')%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleImages(text)%20%7B%0A%20%20%20%20%20%20return%20text.replace(%2F%3Cimg%5B%5E%3E%5D*src%3D%22(%5B%5E%22%5D*)%22%5B%5E%3E%5D*%3E%2Fgi%2C%20(match%2C%20src)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20altMatch%20%3D%20match.match(%2Falt%3D%22(%5B%5E%22%5D*)%22%2Fi)%3B%0A%20%20%20%20%20%20%20%20const%20alt%20%3D%20altMatch%20%3F%20altMatch%5B1%5D%20%3A%20''%3B%0A%20%20%20%20%20%20%20%20return%20%60!%5B%24%7Balt%7D%5D(%24%7Bsrc%7D)%5Cn%60%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleCodeBlocks(html)%20%7B%0A%20%20%20%20%20%20return%20html.replace(%2F%3Cpre%3E%3Ccode.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fcode%3E%3C%5C%2Fpre%3E%2Fgi%2C%20(_%2C%20code)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20langMatch%20%3D%20_.match(%2Fclass%3D%22.*%3Flanguage-(%5Cw%2B).*%3F%22%2Fi)%3B%0A%20%20%20%20%20%20%20%20const%20lang%20%3D%20langMatch%20%3F%20langMatch%5B1%5D%20%3A%20''%3B%0A%20%20%20%20%20%20%20%20const%20processedCode%20%3D%20code%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26lt%3B%2Fg%2C%20'%3C')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26gt%3B%2Fg%2C%20'%3E')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26amp%3B%2Fg%2C%20'%26')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26quot%3B%2Fg%2C%20'%22')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26%2339%3B%2Fg%2C%20%22'%22)%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26nbsp%3B%2Fg%2C%20'%20')%0A%20%20%20%20%20%20%20%20%20%20.trim()%3B%0A%20%20%20%20%20%20%20%20this.codeBlocks.push(%7B%20code%3A%20processedCode%2C%20lang%20%7D)%3B%0A%20%20%20%20%20%20%20%20return%20%60%C2%A7CODE%C2%A7%24%7Bthis.codeBlocks.length%20-%201%7D%C2%A7%60%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleHeadings(text)%20%7B%0A%20%20%20%20%20%20return%20text.replace(%2F%3Ch(%5B1-6%5D).*%3F%3E(.*%3F)%3C%5C%2Fh%5C1%3E%2Fgi%2C%20(_%2C%20level%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20content%20%3D%20content.replace(%2F%3Ca%5B%5E%3E%5D*class%3D%22anchor%22%5B%5E%3E%5D*%3E.*%3F%3C%5C%2Fa%3E%2Fgi%2C%20'')%3B%0A%20%20%20%20%20%20%20%20content%20%3D%20content.replace(%2F%3Ca%5B%5E%3E%5D*%3E(.*%3F)%3C%5C%2Fa%3E%2Fgi%2C%20'%241')%3B%0A%20%20%20%20%20%20%20%20content%20%3D%20this.handleEmoji(content)%3B%0A%20%20%20%20%20%20%20%20return%20%60%5Cn%24%7B'%23'.repeat(level)%7D%20%24%7Bcontent.trim()%7D%5Cn%60%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleEmoji(text)%20%7B%0A%20%20%20%20%20%20return%20text%0A%20%20%20%20%20%20%20%20.replace(%2F%3Cimg%5B%5E%3E%5D*emoji%5B%5E%3E%5D*alt%3D%22(%5B%5E%22%5D*)%22%5B%5E%3E%5D*%3E%2Fgi%2C%20'%3A%241%3A')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Cspan%5B%5E%3E%5D*emoji%5B%5E%3E%5D*%3E(%5B%5E%3C%5D*)%3C%5C%2Fspan%3E%2Fgi%2C%20'%3A%241%3A')%0A%20%20%20%20%20%20%20%20.replace(%2F%3A(%5Ba-z0-9_%2B-%5D%2B)%3A%2Fgi%2C%20'%3A%241%3A')%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleLists(text)%20%7B%0A%20%20%20%20%20%20const%20processNestedList%20%3D%20(content%2C%20indent%20%3D%20'')%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20return%20content%0A%20%20%20%20%20%20%20%20%20%20.replace(%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%3Cul.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Ful%3E%2Fgi%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(_%2C%20list)%20%3D%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20'%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20list.replace(%2F%3Cli.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fli%3E%2Fgi%2C%20(_%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20processedContent%20%3D%20content.trim()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processedContent%20%3D%20this.handleEmoji(processedContent)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processedContent%20%3D%20processNestedList(processedContent%2C%20indent%20%2B%20'%20%20')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%60%24%7Bindent%7D-%20%24%7BprocessedContent%7D%5Cn%60%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%3Col.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fol%3E%2Fgi%2C%20(_%2C%20list)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20counter%20%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20'%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20list.replace(%2F%3Cli.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fli%3E%2Fgi%2C%20(_%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20processedContent%20%3D%20content.trim()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processedContent%20%3D%20this.handleEmoji(processedContent)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processedContent%20%3D%20processNestedList(processedContent%2C%20indent%20%2B%20'%20%20')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%60%24%7Bindent%7D%24%7Bcounter%2B%2B%7D.%20%24%7BprocessedContent%7D%5Cn%60%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20return%20processNestedList(text)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleTables(text)%20%7B%0A%20%20%20%20%20%20return%20text.replace(%2F%3Ctable.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Ftable%3E%2Fgi%2C%20(_%2C%20table)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20rows%20%3D%20table.match(%2F%3Ctr.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Ftr%3E%2Fgi)%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20if%20(!rows.length)%20return%20''%3B%0A%20%20%20%20%20%20%20%20const%20processRow%20%3D%20(row%2C%20isHeader%20%3D%20false)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20cells%20%3D%20row.match(%2F%3Ct%5Bdh%5D.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Ft%5Bdh%5D%3E%2Fgi)%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20alignments%20%3D%20cells.map(cell%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20style%20%3D%20cell.match(%2Fstyle%3D%22%5B%5E%22%5D*text-align%3A%5Cs*(%5B%5E%3B%22%5Cs%5D%2B)%2Fi)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20style%20%3F%20style%5B1%5D%20%3A%20'left'%3B%0A%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20'%7C%20'%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20cells%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20.map((cell%2C%20index)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20content%20%3D%20cell%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.replace(%2F%3Ct%5Bdh%5D.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Ft%5Bdh%5D%3E%2Fi%2C%20'%241')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.replace(%2F%3Cbr%5Cs*%5C%2F%3F%3E%2Fgi%2C%20'%20')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.replace(%2F%5C%7C%2Fg%2C%20'%5C%5C%7C')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.trim()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20content%20%3D%20this.handleEmoji(content)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20content%20%3D%20this.handleInlineFormatting(content)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20content%20%7C%7C%20'%20'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20.join('%20%7C%20')%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%7C'%0A%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20let%20markdown%20%3D%20'%5Cn'%3B%0A%20%20%20%20%20%20%20%20const%20headerRow%20%3D%20rows%5B0%5D.includes('%3Cth')%20%3F%20rows.shift()%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20if%20(headerRow)%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20header%20%3D%20processRow(headerRow%2C%20true)%3B%0A%20%20%20%20%20%20%20%20%20%20const%20cells%20%3D%20headerRow.match(%2F%3Ct%5Bdh%5D.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Ft%5Bdh%5D%3E%2Fgi)%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20alignments%20%3D%20cells.map(cell%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20style%20%3D%20cell.match(%2Fstyle%3D%22%5B%5E%22%5D*text-align%3A%5Cs*(%5B%5E%3B%22%5Cs%5D%2B)%2Fi)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20align%20%3D%20style%20%3F%20style%5B1%5D%20%3A%20'left'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20switch%20(align)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20'center'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20'%3A---%3A'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%20'right'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20'---%3A'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20'%3A---'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20markdown%20%2B%3D%20header%20%2B%20'%5Cn%7C'%20%2B%20alignments.join('%7C')%20%2B%20'%7C%5Cn'%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20markdown%20%2B%3D%20rows.map(row%20%3D%3E%20processRow(row)).join('%5Cn')%20%2B%20'%5Cn'%3B%0A%20%20%20%20%20%20%20%20return%20markdown%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleInlineFormatting(text)%20%7B%0A%20%20%20%20%20%20return%20text%0A%20%20%20%20%20%20%20%20.replace(%2F%3Ckbd%3E(.*%3F)%3C%5C%2Fkbd%3E%2Fgi%2C%20'%60%241%60')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Csub%3E(.*%3F)%3C%5C%2Fsub%3E%2Fgi%2C%20'~%241~')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Csup%3E(.*%3F)%3C%5C%2Fsup%3E%2Fgi%2C%20'%5E%241%5E')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Cmark%3E(.*%3F)%3C%5C%2Fmark%3E%2Fgi%2C%20'%3D%3D%3D%241%3D%3D%3D')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Ccode%5B%5E%3E%5D*%3E(.*%3F)%3C%5C%2Fcode%3E%2Fgi%2C%20'%60%241%60')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Cspan%5B%5E%3E%5D*color%3A%5Cs*(%5B%5E%3B%22%5D%2B)%5B%5E%3E%5D*%3E(.*%3F)%3C%5C%2Fspan%3E%2Fgi%2C%20'%7Bcolor%3D%22%241%22%7D%242%7B%2Fcolor%7D')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Cspan%5B%5E%3E%5D*font-family%3A%5Cs*(%5B%5E%3B%22%5D%2B)%5B%5E%3E%5D*%3E(.*%3F)%3C%5C%2Fspan%3E%2Fgi%2C%20'%7Bfont%3D%22%241%22%7D%242%7B%2Ffont%7D')%0A%20%20%20%20%20%20%20%20.replace(%2F%3Cspan%5B%5E%3E%5D*font-size%3A%5Cs*(%5B%5E%3B%22%5D%2B)%5B%5E%3E%5D*%3E(.*%3F)%3C%5C%2Fspan%3E%2Fgi%2C%20'%7Bsize%3D%22%241%22%7D%242%7B%2Fsize%7D')%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleBlockquotes(text)%20%7B%0A%20%20%20%20%20%20return%20text.replace(%2F%3Cblockquote.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fblockquote%3E%2Fgi%2C%20(_%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20content%20%3D%20this.handleBlockquotes(content)%3B%0A%20%20%20%20%20%20%20%20content%20%3D%20this.handleInlineFormatting(content)%3B%0A%20%20%20%20%20%20%20%20content%20%3D%20this.handleEmoji(content)%3B%0A%20%20%20%20%20%20%20%20const%20authorMatch%20%3D%20content.match(%2F%3Cdiv%5B%5E%3E%5D*class%3D%22%5B%5E%22%5D*quote-author%5B%5E%22%5D*%22%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fdiv%3E%2Fi)%3B%0A%20%20%20%20%20%20%20%20const%20author%20%3D%20authorMatch%20%3F%20authorMatch%5B1%5D.replace(%2F%3C%5B%5E%3E%5D%2B%3E%2Fg%2C%20'').trim()%20%3A%20''%3B%0A%20%20%20%20%20%20%20%20content%20%3D%20content%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%3Cdiv%5B%5E%3E%5D*class%3D%22%5B%5E%22%5D*quote-author%5B%5E%22%5D*%22%5B%5E%3E%5D*%3E%5B%5Cs%5CS%5D*%3F%3C%5C%2Fdiv%3E%2Fi%2C%20'')%0A%20%20%20%20%20%20%20%20%20%20.trim()%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%5Cs%2B%2Fg%2C%20'%20')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%3Cbr%5Cs*%5C%2F%3F%3E%2Fgi%2C%20'%5Cn')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%3Cp.*%3F%3E(.*%3F)%3C%5C%2Fp%3E%2Fgi%2C%20'%241%5Cn')%3B%0A%20%20%20%20%20%20%20%20const%20lines%20%3D%20content%0A%20%20%20%20%20%20%20%20%20%20.split('%5Cn')%0A%20%20%20%20%20%20%20%20%20%20.map(line%20%3D%3E%20line.trim())%0A%20%20%20%20%20%20%20%20%20%20.filter(line%20%3D%3E%20line)%3B%0A%20%20%20%20%20%20%20%20return%20'%5Cn'%20%2B%20(author%20%3F%20%60%3E%20**%24%7Bauthor%7D%3A**%5Cn%60%20%3A%20'')%20%2B%20lines.map(line%20%3D%3E%20%60%3E%20%24%7Bline%7D%60).join('%5Cn')%20%2B%20'%5Cn'%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleDiscourseTags(text)%20%7B%0A%20%20%20%20%20%20return%20text.replace(%2F%3Cspan%20class%3D%22discourse-tag%5B%5E%3E%5D*%3E(%5B%5E%3C%5D%2B)%3C%5C%2Fspan%3E%2Fgi%2C%20'%23%241')%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20handleUserCards(text)%20%7B%0A%20%20%20%20%20%20return%20text.replace(%2F%3Cdiv%20class%3D%22user-card%5B%5E%3E%5D*%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fdiv%3E%2Fgi%2C%20(_%2C%20content)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20name%20%3D%20content.match(%2F%3Cspan%20class%3D%22username%5B%5E%3E%5D*%3E(%5B%5E%3C%5D%2B)%3C%5C%2Fspan%3E%2Fi)%3B%0A%20%20%20%20%20%20%20%20return%20name%20%3F%20%60%40%24%7Bname%5B1%5D%7D%60%20%3A%20''%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20processContent(html)%20%7B%0A%20%20%20%20%20%20const%20tempDiv%20%3D%20document.createElement('div')%3B%0A%20%20%20%20%20%20tempDiv.innerHTML%20%3D%20html%3B%0A%20%20%20%20%20%20%5B'script'%2C%20'style'%2C%20'iframe'%5D.forEach(tag%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20elements%20%3D%20tempDiv.getElementsByTagName(tag)%3B%0A%20%20%20%20%20%20%20%20for%20(let%20i%20%3D%20elements.length%20-%201%3B%20i%20%3E%3D%200%3B%20i--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20elements%5Bi%5D.remove()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20let%20text%20%3D%20tempDiv.innerHTML%3B%0A%20%20%20%20%20%20const%20cached%20%3D%20%7B%0A%20%20%20%20%20%20%20%20codeBlock%3A%20%2F%3Cpre%3E%3Ccode.*%3F%3E(%5B%5Cs%5CS%5D*%3F)%3C%5C%2Fcode%3E%3C%5C%2Fpre%3E%2Fgi%2C%0A%20%20%20%20%20%20%20%20inlineCode%3A%20%2F%3Ccode%5B%5E%3E%5D*%3E(.*%3F)%3C%5C%2Fcode%3E%2Fgi%2C%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20text%20%3D%20text.replace(cached.codeBlock%2C%20(match%2C%20code)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20langMatch%20%3D%20_.match(%2Fclass%3D%22.*%3Flanguage-(%5Cw%2B).*%3F%22%2Fi)%3B%0A%20%20%20%20%20%20%20%20const%20lang%20%3D%20langMatch%20%3F%20langMatch%5B1%5D%20%3A%20''%3B%0A%20%20%20%20%20%20%20%20const%20processedCode%20%3D%20code%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26lt%3B%2Fg%2C%20'%3C')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26gt%3B%2Fg%2C%20'%3E')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26amp%3B%2Fg%2C%20'%26')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26quot%3B%2Fg%2C%20'%22')%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26%2339%3B%2Fg%2C%20%22'%22)%0A%20%20%20%20%20%20%20%20%20%20.replace(%2F%26nbsp%3B%2Fg%2C%20'%20')%0A%20%20%20%20%20%20%20%20%20%20.trim()%3B%0A%20%20%20%20%20%20%20%20this.codeBlocks.push(%7B%20code%3A%20processedCode%2C%20lang%20%7D)%3B%0A%20%20%20%20%20%20%20%20return%20%60%C2%A7CODE%C2%A7%24%7Bthis.codeBlocks.length%20-%201%7D%C2%A7%60%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20for%20(const%20rule%20of%20this.rules)%20%7B%0A%20%20%20%20%20%20%20%20text%20%3D%20text.replace(rule.pattern%2C%20rule.replacement)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20text%20%3D%20this.handleLocalDates(text)%3B%0A%20%20%20%20%20%20text%20%3D%20this.handleDiscourseDetails(text)%3B%0A%20%20%20%20%20%20text%20%3D%20this.handleDiscourseCategories(text)%3B%0A%20%20%20%20%20%20text%20%3D%20this.handleImages(text)%3B%0A%20%20%20%20%20%20text%20%3D%20this.handleHeadings(text)%3B%0A%20%20%20%20%20%20text%20%3D%20this.handleLists(text)%3B%0A%20%20%20%20%20%20text%20%3D%20this.handleTables(text)%3B%0A%20%20%20%20%20%20text%20%3D%20this.handleBlockquotes(text)%3B%0A%20%20%20%20%20%20text%20%3D%20this.handleDiscourseTags(text)%3B%0A%20%20%20%20%20%20text%20%3D%20this.handleUserCards(text)%3B%0A%20%20%20%20%20%20return%20text%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20cleanup(text)%20%7B%0A%20%20%20%20%20%20return%20text%0A%20%20%20%20%20%20%20%20.replace(%2F%C2%A7CODE%C2%A7(%5Cd%2B)%C2%A7%2Fg%2C%20(_%2C%20index)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20block%20%3D%20this.codeBlocks%5Bindex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20lang%20%3D%20block.lang%20%7C%7C%20''%3B%0A%20%20%20%20%20%20%20%20%20%20const%20code%20%3D%20block.code%3B%0A%20%20%20%20%20%20%20%20%20%20return%20%60%5Cn%5C%60%5C%60%5C%60%24%7Blang%7D%5Cn%24%7Bcode%7D%5Cn%5C%60%5C%60%5C%60%5Cn%60%3B%0A%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20.replace(%2F%3C%5B%5E%3E%5D%2B%3E%2Fg%2C%20'')%0A%20%20%20%20%20%20%20%20.replace(%2F%26nbsp%3B%2Fg%2C%20'%20')%0A%20%20%20%20%20%20%20%20.replace(%2F%26lt%3B%2Fg%2C%20'%3C')%0A%20%20%20%20%20%20%20%20.replace(%2F%26gt%3B%2Fg%2C%20'%3E')%0A%20%20%20%20%20%20%20%20.replace(%2F%26amp%3B%2Fg%2C%20'%26')%0A%20%20%20%20%20%20%20%20.replace(%2F%26quot%3B%2Fg%2C%20'%22')%0A%20%20%20%20%20%20%20%20.replace(%2F%26%2339%3B%2Fg%2C%20%22'%22)%0A%20%20%20%20%20%20%20%20.replace(%2F%5Cn%7B3%2C%7D%2Fg%2C%20'%5Cn%5Cn')%0A%20%20%20%20%20%20%20%20.replace(%2F%5Cn%5Cs%2B%5Cn%2Fg%2C%20'%5Cn%5Cn')%0A%20%20%20%20%20%20%20%20.trim()%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20fallbackConvert(html)%20%7B%0A%20%20%20%20%20%20return%20html%0A%20%20%20%20%20%20%20%20.replace(%2F%3C%5B%5E%3E%5D%2B%3E%2Fg%2C%20'')%0A%20%20%20%20%20%20%20%20.replace(%2F%26%5B%5E%3B%5D%2B%3B%2Fg%2C%20'')%0A%20%20%20%20%20%20%20%20.trim()%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20checkCompatibility()%20%7B%0A%20%20%20%20%20%20const%20features%20%3D%20%7B%0A%20%20%20%20%20%20%20%20clipboard%3A%20'clipboard'%20in%20navigator%2C%0A%20%20%20%20%20%20%20%20customElements%3A%20'customElements'%20in%20window%2C%0A%20%20%20%20%20%20%20%20documentFragment%3A%20'DocumentFragment'%20in%20window%2C%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20const%20missing%20%3D%20Object.entries(features)%0A%20%20%20%20%20%20%20%20.filter((%5B_%2C%20supported%5D)%20%3D%3E%20!supported)%0A%20%20%20%20%20%20%20%20.map((%5Bfeature%5D)%20%3D%3E%20feature)%3B%0A%20%20%20%20%20%20if%20(missing.length)%20%7B%0A%20%20%20%20%20%20%20%20console.warn('%E4%B8%8D%E6%94%AF%E6%8C%81%E7%9A%84%E7%89%B9%E6%80%A7%3A'%2C%20missing.join('%2C%20'))%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%2C%0A%20%20%7D%3B%0A%20%20function%20getPageContent()%20%7B%0A%20%20%20%20const%20titleEl%20%3D%20document.querySelector('%23topic-title%20%3E%20div%20%3E%20h1%20%3E%20a.fancy-title%20%3E%20span')%3B%0A%20%20%20%20const%20contentEl%20%3D%20document.querySelector(%0A%20%20%20%20%20%20'%23post_1%20%3E%20div.row%20%3E%20div.topic-body.clearfix%20%3E%20div.regular.contents%20%3E%20div.cooked'%0A%20%20%20%20)%3B%0A%20%20%20%20if%20(!contentEl)%20%7B%0A%20%20%20%20%20%20throw%20new%20Error('%E6%97%A0%E6%B3%95%E8%8E%B7%E5%8F%96%E6%96%87%E7%AB%A0%E5%86%85%E5%AE%B9')%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%7B%20title%3A%20titleEl%3F.textContent%3F.trim()%20%3F%3F%20'Untitled'%2C%20content%3A%20contentEl.innerHTML%20%7D%3B%0A%20%20%7D%0A%20%20try%20%7B%0A%20%20%20%20const%20%7B%20title%2C%20content%20%7D%20%3D%20getPageContent()%3B%0A%20%20%20%20const%20markdown%20%3D%20%60%23%20%24%7Btitle%7D%5Cn%5Cn%24%7BHtmlToMarkdown.convert(content)%7D%60%3B%0A%20%20%20%20navigator.clipboard%0A%20%20%20%20%20%20.writeText(markdown)%0A%20%20%20%20%20%20.then(()%20%3D%3E%20alert('%E5%B7%B2%E5%A4%8D%E5%88%B6'))%0A%20%20%20%20%20%20.catch(err%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20console.error('%E5%A4%8D%E5%88%B6%E5%A4%B1%E8%B4%A5%3A'%2C%20err)%3B%0A%20%20%20%20%20%20%20%20alert('%E5%A4%8D%E5%88%B6%E5%A4%B1%E8%B4%A5%EF%BC%8C%E8%AF%B7%E6%A3%80%E6%9F%A5%E6%B5%8F%E8%A7%88%E5%99%A8%E6%9D%83%E9%99%90%E8%AE%BE%E7%BD%AE%2F%E5%85%B3%E9%97%ADF12')%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20alert(error.message)%3B%0A%20%20%7D%0A%7D)()%3B%7D)()%3B